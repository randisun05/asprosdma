import{L as k}from"./Admin.9e911934.js";import{G as C,a as x}from"./GenerateQRCode.1752f322.js";import{M}from"./MemberCard.e8ecf3a4.js";import{P as q}from"./Pagination.ea362670.js";import{H as L,L as R,r as w,a as p,o as n,c as l,b as u,w as _,d as e,e as E,f as I,v as N,F as y,j as S,g as f,k as Q,i as U,t as c}from"./app.54841f97.js";import{S as v}from"./sweetalert2.all.a4722dba.js";import{_ as F}from"./_plugin-vue_export-helper.cdc0426e.js";const P={layout:k,components:{Head:L,Link:R,Pagination:q,GenerateQRCode:C,MemberCard:M},props:{errors:Object,datas:Object},data(){return{showModal:!1,qrCode:null,text:""}},methods:{async showQrModal(m){try{const o=await x.post(`${window.location.origin}/admin/generate-qr`,{text:m},{responseType:"blob"}),t=URL.createObjectURL(o.data);this.qrCode=t,this.showModal=!0}catch(o){console.error("Error generating QR code:",o)}},closeModal(){this.showModal=!1,this.qrCode=null}},setup(m){const o=i=>`/storage/${i}`,t=w(new URL(document.location).searchParams.get("q")),a=()=>{Q.Inertia.get("/admin/members",{q:t.value})},r=w(!1);return{search:t,handleSearch:a,showModalEmail:r,downloadCard:async i=>{if(i.main.image===null)v.fire("Error","Foto anggota belum diupload","error");else try{const d=document.getElementById("downloadFrame"),h=`/admin/member-card/download/${i.main_id}`;d.src=h,d.onload=()=>{console.log("Rendering completed in iframe, starting download of backcard...")}}catch(d){console.error("Error downloading card:",d),v.fire("Error","Error","error")}},getImageUrl:o}}},V={class:"container-fluid padding px-5"},j={class:"row"},A={class:"col-md-12"},B={class:"row"},H={class:"col-md-1 col-12 mb-2"},D={class:"col-md-6 col-12 mb-2"},O={class:"input-group"},T={class:"row mt-1"},G={class:"col-md-12"},J={class:"card border-0 shadow"},z={class:"card-body"},K={class:"table-responsive"},W={class:"table table-bordered table-centered table-nowrap mb-0 rounded"},X={class:"fw-bold text-center"},Y={class:"text-center"},Z=["href"],$=["href"],ee=["onClick"],oe={key:0,class:"modal fade show",style:{display:"block"},tabindex:"-1",role:"dialog"},se={class:"modal-dialog modal-dialog-centered",role:"document"},te={class:"modal-content"},ae={class:"modal-header"},re={class:"modal-body text-center"},de=["src"],ne={class:"modal-footer"},le=["href"];function ie(m,o,t,a,r,b){const i=p("Head"),d=p("Link"),h=p("Pagination");return n(),l(y,null,[u(i,null,{default:_(()=>[...o[4]||(o[4]=[e("title",null,"Administrator",-1)])]),_:1}),e("div",V,[e("div",j,[e("div",A,[e("div",B,[e("div",H,[u(d,{href:"/admin/members/report",class:"btn btn-md btn-primary border-0 shadow w-100",type:"button"},{default:_(()=>[...o[5]||(o[5]=[e("i",{class:"fa fa-file-pdf","aria-hidden":"true"},null,-1),U(" Report",-1)])]),_:1})]),e("div",D,[e("form",{onSubmit:o[1]||(o[1]=E((...s)=>a.handleSearch&&a.handleSearch(...s),["prevent"]))},[e("div",O,[I(e("input",{type:"text",class:"form-control border-0 shadow","onUpdate:modelValue":o[0]||(o[0]=s=>a.search=s),placeholder:"masukkan kata kunci dan enter..."},null,512),[[N,a.search]]),o[6]||(o[6]=e("span",{class:"input-group-text border-0 shadow"},[e("i",{class:"fa fa-search"})],-1))])],32)])])])]),e("div",T,[e("div",G,[e("div",J,[e("div",z,[e("div",K,[e("table",W,[o[11]||(o[11]=e("thead",{class:"thead-dark"},[e("tr",{class:"border-0 text-center"},[e("th",{class:"border-0 rounded-start",style:{width:"5%"}},"No."),e("th",{class:"border-0"},"No Anggota"),e("th",{class:"border-0"},"Nama"),e("th",{class:"border-0"},"Jabatan"),e("th",{class:"border-0"},"Instansi"),e("th",{class:"border-0 rounded-end",style:{width:"12%"}},"Aksi")])],-1)),o[12]||(o[12]=e("div",{class:"mt-2"},null,-1)),e("tbody",null,[(n(!0),l(y,null,S(t.datas.data,(s,g)=>(n(),l("tr",{key:g},[e("td",X,c(++g+(t.datas.current_page-1)*t.datas.per_page),1),e("td",null,c(s.main.nomember),1),e("td",null,c(s.main.name),1),e("td",null,c(s.position)+" "+c(s.level),1),e("td",null,c(s.agency),1),e("td",Y,[u(d,{href:`/admin/members/${s.id}`,title:"view",class:"btn btn-sm btn-primary border-0 shadow me-1",type:"button"},{default:_(()=>[...o[7]||(o[7]=[e("i",{class:"fa fa-eye fa-lg","aria-hidden":"true"},null,-1)])]),_:1},8,["href"]),m.$page.props.auth.user.role=="administrator"||m.$page.props.auth.user.role=="keanggotaan"?(n(),l("a",{key:0,href:`/admin/members/${s.id}/edit`,title:"edit",class:"btn btn-sm btn-warning border-0 shadow me-1"},[...o[8]||(o[8]=[e("i",{class:"fa fa-pencil fa-lg","aria-hidden":"true"},null,-1)])],8,Z)):f("",!0),e("a",{href:`/admin/members/qrcode/${s.id}`,class:"btn btn-sm btn-info border-0 shadow me-1",type:"button"},[...o[9]||(o[9]=[e("i",{class:"fa fa-qrcode fa-lg","aria-hidden":"true"},null,-1)])],8,$),e("button",{onClick:ce=>a.downloadCard(s),class:"btn btn-sm btn-success border-0 shadow me-1",type:"button"},[...o[10]||(o[10]=[e("i",{class:"fa fa-id-card","aria-hidden":"true"},null,-1)])],8,ee)])]))),128))])])]),u(h,{links:t.datas.links,align:"end"},null,8,["links"])])])])])]),r.showModal?(n(),l("div",oe,[e("div",se,[e("div",te,[e("div",ae,[o[14]||(o[14]=e("h5",{class:"modal-title"},"QR Code",-1)),e("button",{type:"button",class:"close",onClick:o[2]||(o[2]=(...s)=>b.closeModal&&b.closeModal(...s)),"aria-label":"Close"},[...o[13]||(o[13]=[e("span",{"aria-hidden":"true"},"\xD7",-1)])])]),e("div",re,[r.qrCode?(n(),l("img",{key:0,src:r.qrCode,alt:"QR Code"},null,8,de)):f("",!0)]),e("div",ne,[r.qrCode?(n(),l("a",{key:0,href:r.qrCode,download:"qr-code.png",class:"btn btn-success"}," Download QR Code ",8,le)):f("",!0),e("button",{type:"button",class:"btn btn-secondary",onClick:o[3]||(o[3]=(...s)=>b.closeModal&&b.closeModal(...s))},"Close")])])])])):f("",!0),o[15]||(o[15]=e("iframe",{id:"downloadFrame",style:{visibility:"hidden"}},null,-1))],64)}const ge=F(P,[["render",ie],["__scopeId","data-v-abf9d1fb"]]);export{ge as default};
