import{L as C}from"./Admin.8869ede1.js";import{G as x,a as M}from"./GenerateQRCode.463b9ef8.js";import{M as q}from"./MemberCard.e63c12b3.js";import{P as I}from"./Pagination.1da0fc1f.js";import{H as L,L as R,r as y,a as p,o as i,c,b,w as g,d as e,e as S,f as E,v as N,F as v,j as Q,g as u,k as U,t as h,p as F,l as P,i as V}from"./app.13ad01c3.js";import{S as k}from"./sweetalert2.all.bc3acd74.js";import{_ as j}from"./_plugin-vue_export-helper.cdc0426e.js";const A={layout:C,components:{Head:L,Link:R,Pagination:I,GenerateQRCode:x,MemberCard:q},props:{errors:Object,datas:Object},data(){return{showModal:!1,qrCode:null,text:""}},methods:{async showQrModal(a){try{const s=await M.post(`${window.location.origin}/admin/generate-qr`,{text:a},{responseType:"blob"}),d=URL.createObjectURL(s.data);this.qrCode=d,this.showModal=!0}catch(s){console.error("Error generating QR code:",s)}},closeModal(){this.showModal=!1,this.qrCode=null}},setup(a){const s=_=>`/storage/${_}`,d=y(new URL(document.location).searchParams.get("q")),n=()=>{U.Inertia.get("/admin/members",{q:d.value})},r=y(!1);return{search:d,handleSearch:n,showModalEmail:r,downloadCard:async _=>{if(_.main.image===null)k.fire("Error","Foto anggota belum diupload","error");else try{const l=document.getElementById("downloadFrame"),f=`/admin/member-card/download/${_.main_id}`;l.src=f,l.onload=()=>{console.log("Rendering completed in iframe, starting download of backcard...")}}catch(l){console.error("Error downloading card:",l),k.fire("Error","Error","error")}},getImageUrl:s}}},t=a=>(F("data-v-abf9d1fb"),a=a(),P(),a),B=t(()=>e("title",null,"Administrator",-1)),H={class:"container-fluid padding px-5"},D={class:"row"},O={class:"col-md-12"},T={class:"row"},G={class:"col-md-1 col-12 mb-2"},J=t(()=>e("i",{class:"fa fa-file-pdf","aria-hidden":"true"},null,-1)),z=V(" Report"),K={class:"col-md-6 col-12 mb-2"},W={class:"input-group"},X=t(()=>e("span",{class:"input-group-text border-0 shadow"},[e("i",{class:"fa fa-search"})],-1)),Y={class:"row mt-1"},Z={class:"col-md-12"},$={class:"card border-0 shadow"},ee={class:"card-body"},oe={class:"table-responsive"},se={class:"table table-bordered table-centered table-nowrap mb-0 rounded"},te=t(()=>e("thead",{class:"thead-dark"},[e("tr",{class:"border-0 text-center"},[e("th",{class:"border-0 rounded-start",style:{width:"5%"}},"No."),e("th",{class:"border-0"},"No Anggota"),e("th",{class:"border-0"},"Nama"),e("th",{class:"border-0"},"Jabatan"),e("th",{class:"border-0"},"Instansi"),e("th",{class:"border-0 rounded-end",style:{width:"12%"}},"Aksi")])],-1)),ae=t(()=>e("div",{class:"mt-2"},null,-1)),de={class:"fw-bold text-center"},ne={class:"text-center"},re=t(()=>e("i",{class:"fa fa-eye fa-lg","aria-hidden":"true"},null,-1)),le=["href"],ie=t(()=>e("i",{class:"fa fa-pencil fa-lg","aria-hidden":"true"},null,-1)),ce=[ie],_e=["href"],he=t(()=>e("i",{class:"fa fa-qrcode fa-lg","aria-hidden":"true"},null,-1)),me=[he],be=["onClick"],ue=t(()=>e("i",{class:"fa fa-id-card","aria-hidden":"true"},null,-1)),fe=[ue],pe={key:0,class:"modal fade show",style:{display:"block"},tabindex:"-1",role:"dialog"},ge={class:"modal-dialog modal-dialog-centered",role:"document"},we={class:"modal-content"},ye={class:"modal-header"},ve=t(()=>e("h5",{class:"modal-title"},"QR Code",-1)),ke=t(()=>e("span",{"aria-hidden":"true"},"\xD7",-1)),Ce=[ke],xe={class:"modal-body text-center"},Me=["src"],qe={class:"modal-footer"},Ie=["href"],Le=t(()=>e("iframe",{id:"downloadFrame",style:{visibility:"hidden"}},null,-1));function Re(a,s,d,n,r,m){const _=p("Head"),l=p("Link"),f=p("Pagination");return i(),c(v,null,[b(_,null,{default:g(()=>[B]),_:1}),e("div",H,[e("div",D,[e("div",O,[e("div",T,[e("div",G,[b(l,{href:"/admin/members/report",class:"btn btn-md btn-primary border-0 shadow w-100",type:"button"},{default:g(()=>[J,z]),_:1})]),e("div",K,[e("form",{onSubmit:s[1]||(s[1]=S((...o)=>n.handleSearch&&n.handleSearch(...o),["prevent"]))},[e("div",W,[E(e("input",{type:"text",class:"form-control border-0 shadow","onUpdate:modelValue":s[0]||(s[0]=o=>n.search=o),placeholder:"masukkan kata kunci dan enter..."},null,512),[[N,n.search]]),X])],32)])])])]),e("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[e("div",oe,[e("table",se,[te,ae,e("tbody",null,[(i(!0),c(v,null,Q(d.datas.data,(o,w)=>(i(),c("tr",{key:w},[e("td",de,h(++w+(d.datas.current_page-1)*d.datas.per_page),1),e("td",null,h(o.main.nomember),1),e("td",null,h(o.main.name),1),e("td",null,h(o.position)+" "+h(o.level),1),e("td",null,h(o.agency),1),e("td",ne,[b(l,{href:`/admin/members/${o.id}`,title:"view",class:"btn btn-sm btn-primary border-0 shadow me-1",type:"button"},{default:g(()=>[re]),_:2},1032,["href"]),a.$page.props.auth.user.role=="administrator"||a.$page.props.auth.user.role=="keanggotaan"?(i(),c("a",{key:0,href:`/admin/members/${o.id}/edit`,title:"edit",class:"btn btn-sm btn-warning border-0 shadow me-1"},ce,8,le)):u("",!0),e("a",{href:`/admin/members/qrcode/${o.id}`,class:"btn btn-sm btn-info border-0 shadow me-1",type:"button"},me,8,_e),e("button",{onClick:Se=>n.downloadCard(o),class:"btn btn-sm btn-success border-0 shadow me-1",type:"button"},fe,8,be)])]))),128))])])]),b(f,{links:d.datas.links,align:"end"},null,8,["links"])])])])])]),r.showModal?(i(),c("div",pe,[e("div",ge,[e("div",we,[e("div",ye,[ve,e("button",{type:"button",class:"close",onClick:s[2]||(s[2]=(...o)=>m.closeModal&&m.closeModal(...o)),"aria-label":"Close"},Ce)]),e("div",xe,[r.qrCode?(i(),c("img",{key:0,src:r.qrCode,alt:"QR Code"},null,8,Me)):u("",!0)]),e("div",qe,[r.qrCode?(i(),c("a",{key:0,href:r.qrCode,download:"qr-code.png",class:"btn btn-success"}," Download QR Code ",8,Ie)):u("",!0),e("button",{type:"button",class:"btn btn-secondary",onClick:s[3]||(s[3]=(...o)=>m.closeModal&&m.closeModal(...o))},"Close")])])])])):u("",!0),Le],64)}const je=j(A,[["render",Re],["__scopeId","data-v-abf9d1fb"]]);export{je as default};
